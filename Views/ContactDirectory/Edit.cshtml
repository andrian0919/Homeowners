@model HomeownersSubdivision.Models.ContactDirectory
@using HomeownersSubdivision.Models

@{
    ViewData["Title"] = "Edit Contact";
}

<div class="bg-white p-6 rounded-lg shadow-md">
    <div class="mb-6 flex justify-between items-center">
        <h1 class="text-2xl font-bold text-gray-800">Edit Contact</h1>
        
        <div class="flex space-x-2">
            <a asp-action="Index" class="btn-secondary">
                <i class="bi bi-arrow-left me-1"></i> Back to Directory
            </a>
            <a asp-action="Details" asp-route-id="@Model.Id" class="btn-secondary">
                <i class="bi bi-info-circle me-1"></i> View Details
            </a>
        </div>
    </div>

    <div class="bg-gray-50 p-6 rounded-lg">
        <form asp-action="Edit" method="post">
            <div asp-validation-summary="ModelOnly" class="text-red-500 mb-4"></div>
            <input type="hidden" asp-for="Id" />
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Contact Information</h3>
                    
                    <div class="mb-4">
                        <label asp-for="Name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                        <input asp-for="Name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required />
                        <span asp-validation-for="Name" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="Title" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                        <input asp-for="Title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required />
                        <span asp-validation-for="Title" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="Department" class="block text-sm font-medium text-gray-700 mb-1">Department</label>
                        <input asp-for="Department" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required />
                        <span asp-validation-for="Department" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="Category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <select asp-for="Category" asp-items="Html.GetEnumSelectList<ContactCategory>()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </select>
                        <span asp-validation-for="Category" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="PhoneNumber" class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                        <input asp-for="PhoneNumber" type="tel" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" required />
                        <span asp-validation-for="PhoneNumber" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="Email" class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                        <input asp-for="Email" type="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        <span asp-validation-for="Email" class="text-red-500 text-sm"></span>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Location & Additional Information</h3>
                    
                    <div class="mb-4">
                        <label asp-for="Office" class="block text-sm font-medium text-gray-700 mb-1">Office</label>
                        <input asp-for="Office" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        <span asp-validation-for="Office" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="Address" class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                        <input asp-for="Address" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        <span asp-validation-for="Address" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="WorkingHours" class="block text-sm font-medium text-gray-700 mb-1">Working Hours</label>
                        <input asp-for="WorkingHours" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g. Mon-Fri: 9:00 AM - 5:00 PM" />
                        <span asp-validation-for="WorkingHours" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="Notes" class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
                        <textarea asp-for="Notes" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        <span asp-validation-for="Notes" class="text-red-500 text-sm"></span>
                    </div>
                    
                    <div class="mb-4">
                        <label asp-for="SortOrder" class="block text-sm font-medium text-gray-700 mb-1">Sort Order</label>
                        <input asp-for="SortOrder" type="number" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        <span asp-validation-for="SortOrder" class="text-red-500 text-sm"></span>
                        <p class="text-gray-500 text-sm mt-1">Lower numbers appear first in the list</p>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 pt-6 border-t">
                <h3 class="text-lg font-semibold text-gray-700 mb-4">Visibility & Status</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <p class="text-sm text-gray-600 mb-3">Who should be able to see this contact?</p>
                        <div class="flex flex-wrap gap-4">
                            <div class="flex items-center">
                                <input type="checkbox" id="admin-visible" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" onchange="updateVisibility()" />
                                <label for="admin-visible" class="ml-2 block text-sm text-gray-900">Administrators</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="staff-visible" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" onchange="updateVisibility()" />
                                <label for="staff-visible" class="ml-2 block text-sm text-gray-900">Staff Members</label>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="homeowner-visible" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" onchange="updateVisibility()" />
                                <label for="homeowner-visible" class="ml-2 block text-sm text-gray-900">Homeowners</label>
                            </div>
                        </div>
                        
                        <input asp-for="VisibleToRoles" type="hidden" id="visibility-value" />
                    </div>
                    
                    <div>
                        <p class="text-sm text-gray-600 mb-3">Is this contact currently active?</p>
                        <div class="flex items-center">
                            <input asp-for="IsActive" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" />
                            <label asp-for="IsActive" class="ml-2 block text-sm text-gray-900">Active</label>
                        </div>
                        <p class="text-gray-500 text-sm mt-1">Inactive contacts will not be shown in the directory</p>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 flex justify-between">
                <a asp-action="Delete" asp-route-id="@Model.Id" class="text-red-500 hover:text-red-700">
                    <i class="bi bi-trash"></i> Delete
                </a>
                
                <button type="submit" class="btn-primary">
                    <i class="bi bi-save me-1"></i> Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const visibilityValue = parseInt(document.getElementById('visibility-value').value) || 0;
            
            document.getElementById('admin-visible').checked = (visibilityValue & 1) !== 0;
            document.getElementById('staff-visible').checked = (visibilityValue & 2) !== 0;
            document.getElementById('homeowner-visible').checked = (visibilityValue & 4) !== 0;
        });
        
        function updateVisibility() {
            const adminVisible = document.getElementById('admin-visible').checked;
            const staffVisible = document.getElementById('staff-visible').checked;
            const homeownerVisible = document.getElementById('homeowner-visible').checked;
            
            let visibilityValue = 0;
            
            if (adminVisible) visibilityValue |= 1;
            if (staffVisible) visibilityValue |= 2;
            if (homeownerVisible) visibilityValue |= 4;
            
            document.getElementById('visibility-value').value = visibilityValue;
        }
    </script>
}

@section Styles {
    <style>
        .btn-primary {
            bg-adminPrimary hover:bg-adminSecondary text-white font-medium py-2 px-4 rounded inline-flex items-center transition-colors;
        }
        
        .btn-secondary {
            bg-white text-gray-700 border border-gray-300 font-medium py-2 px-4 rounded inline-flex items-center hover:bg-gray-50 transition-colors;
        }
    </style>
} 